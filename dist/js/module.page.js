!function(e){"use strict";window.jiZhuReader={create:function(){var e=this;e.iframe||(e.dealPage(),e.insertIframe(),e.addWindowEventListener())},dealPage:function(){var t=this,n="jizhureader-beforereader",a="jizhureader-reader",o=e("html, body").addClass(n);t.hidePage=function(){o.addClass(n)},t.removeIframe=function(){o.removeClass(n).removeClass(a),t.iframe.removeClass("jizhureader-iframe-open"),setTimeout(function(){t.iframe.remove(),t.iframe=null},300),clearTimeout(jiZhuReaderGetPageContent.getContentTimer)},t.afterInitReader=function(){e(window).scrollTop(0),o.addClass(a)},e(document).keydown(function(e){27===e.which&&t.removeIframe()})},insertIframe:function(){var t=this;t.iframe=e("<iframe>",{id:"jizhureader-iframe",frameborder:0,allowtransparency:!0,scrolling:"auto",src:chrome.extension.getURL("reader.html")}).appendTo(document.body),setTimeout(function(){t.iframe.addClass("jizhureader-iframe-open")},0)},getPageContent:function(){window.jiZhuReaderGetPageContent.getCurrentContent(function(e){var t=chrome.extension.connect({name:"articlefrompage"});t.postMessage({content:e||chrome.i18n.getMessage("ClipFailedTip"),title:document.title,url:window.location.href});var n=window.location;""!==n.pathname&&jiZhuReaderGetPageContent.findNextPageContent(document,n.origin+n.pathname+n.search,e)})},saveContent:function(e){var t=chrome.extension.connect({name:"savecontent"});e&&t.postMessage({noteContent:e,noteTitle:document.title,noteUrl:window.location.href})},addWindowEventListener:function(){var e=this;e.eventInited||(window.addEventListener("message",function(t){switch(t.data.name){case"afterinitreader":e.afterInitReader();break;case"getpagecontent":e.getPageContent();break;case"removeiframe":e.removeIframe();break;case"savecontent":e.saveContent(t.data.noteContent)}},!0),e.eventInited=!0)}}}(Zepto);